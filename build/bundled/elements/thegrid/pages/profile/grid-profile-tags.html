<html><head></head><body><dom-module id="grid-profile-skills"><template><style include="grid iron-flex">:host{display:block;position:relative;width:100%;height:100%;margin:0 auto;background:var(--dark-red);}.auto-complete{position:absolute;top:52px;background:#FFFFFF;left:0;right:0;border-bottom-left-radius:2px;border-bottom-right-radius:2px;display:none;min-height:0px;max-height:400px;z-index:1;overflow-y:auto;}.auto-complete .row{padding:8px 16px;border-top:1px solid rgba(0,0,0, 0.12);position:relative;}.auto-complete .row span{display:block;}.auto-complete .row span[secondary]{opacity:0.38;}.skills-container{overflow-y:auto;max-height:350px;padding:32px 0;}.skills-container::-webkit-scrollbar{width:0px;background:transparent;}.selected{background:rgba(142, 142, 142, 0.13);}</style><div id="toolbar" class="toolbar"><paper-icon-button icon="chevron-left" class="white pointer" on-click="redirectProfile"></paper-icon-button><span class="flex"></span></div><div class="p-y-1"><div class="header-text-container"><h1 class="header-text m-0"><span>My Tags</span></h1></div><form class="form" action="#"><div class="input-group suffix"><input id="tag" type="text" class="input" autocomplete="off" autofocus="" value="{{query::input}}" placeholder="Search available tag.."><div class="addon-suffix"><paper-spinner active$="[[isAddingSkill]]" class="red" hidden$="[[!isAddingSkill]]"></paper-spinner><span class="input-action pointer" on-click="cancelSearch" hidden$="[[isAddingSkill]]"><iron-icon icon="close" class="red"></iron-icon></span></div><div id="result" class="auto-complete"><template is="dom-repeat" items="[[ tags ]]" as="tag" filter="{{_filter(query)}}"><div class="row" on-click="select"><span>[[ tag.name ]]</span> <span secondary="">[[ tag.type.name ]]</span><paper-ripple></paper-ripple></div></template></div></div></form><div class="skills-container"><template is="dom-repeat" items="[[ selected_tags ]]" as="tag"><div class="chip"><span>[[ tag.name ]]</span> <span class="close"><iron-icon icon="close" class="small" on-click="removeTag"></iron-icon></span></div></template></div></div></template><script>class GridProfileSkills extends GridNavigation(ReduxAsyncActionBehavior(ReduxBehavior(Polymer.Element))){static get is(){return'grid-profile-skills'}static get properties(){return{user:{type:Object,statePath:'user'},tags:{type:Array,value:[]},selected_tags:{type:Array,statePath:'user.tags'}}}static get observers(){return['_subrouteDataChange(subrouteData)','_searching(query)','_user(user)']}constructor(){super();this;this.isAddingSkill=!1,axios.get(`${this.url.API_URL}/tags`).then((a)=>{this.tags=a.data})}connectedCallback(){super.connectedCallback();const a=this,b=this.$.tag;a.selected=-1,a.scroll=0;b.addEventListener('keydown',function(b){const c=a.shadowRoot.querySelector('#result'),d=c.querySelectorAll('.row'),e=c.offsetHeight;if(40==b.keyCode){if(a.selected==d.length-1)return;b.preventDefault(),b.stopPropagation();var f=d[a.selected];f&&f.classList.remove('selected'),a.selected+=1,d[a.selected]&&(f=d[a.selected],f.classList.add('selected'),e<a.selected*f.offsetHeight+f.offsetHeight&&(c.scrollTop+=f.offsetHeight))}if(38==b.keyCode){if(-1==a.selected)return;b.preventDefault(),b.stopPropagation();var f=d[a.selected];f&&f.classList.remove('selected'),a.selected-=1,d[a.selected]&&(f=d[a.selected],f.classList.add('selected'),c.scrollTop>a.selected*f.offsetHeight&&(c.scrollTop-=f.offsetHeight))}13==b.keyCode&&(b.preventDefault(),b.stopPropagation(),d[a.selected].click())})}select(a){const b=a.model.tag;var c=this.selected_tags.find(function(a){return a.id===b.id});c||(this.dispatch('addTag',b),gAxios.post(`/users/${this.user.id}/tags`,{tag_id:b.id}).then(()=>{})),this.set('query',''),this.$.tag.focus()}cancelSearch(){this.set('query','')}removeTag(a){const b=a.model.tag,c=this.selected_tags.indexOf(b);console.log(b,c),-1!=c&&(this.dispatch('removeTag',c),gAxios.delete(`/users/${this.user.id}/tags/${b.id}`).then(()=>{}))}_searching(a){this.selected=-1;const b=this.shadowRoot.querySelector('#result'),c=b.querySelectorAll('.row');var d=55;c[0]&&(d=c[0].offsetHeight,0>=d&&(d=55)),c.forEach((a)=>{a.classList.remove('selected')}),b.scrollTop=0,b.style.maxHeight=5*d+'px',this.$.result.style.display=''==a?'none':'block'}_filter(a){return a?(a=a.toLowerCase(),function(b){var c=b.name.toLowerCase();return-1!=c.indexOf(a)}):null}_user(a){const b=this;a&&gAxios.get('/users/'+a.id+'/skills').then((a)=>{b.set('selectedSkills',a.data)})}_subrouteDataChange(a){console.log(a)}}customElements.define(GridProfileSkills.is,GridProfileSkills);</script></dom-module></body></html>