<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="social-button" assetpath="../components/"><template><style>:host{display:block;}:host(.facebook) paper-button{background-color:#4267B2;color:#FFFFFF;}:host(.google) paper-button{background-color:#FFFFFF;color:#757575;}paper-button{width:100%;color:#FFFFFF;margin:0;height:44px;text-transform:none;padding:0 16px;position:relative;}::slotted(.icon){position:absolute;left:16px;}</style><paper-button><slot select=".icon"></slot><slot select="span"></slot></paper-button></template><script>class SocialButton extends Polymer.Element{static get is(){return'social-button'}}customElements.define(SocialButton.is,SocialButton);</script></dom-module><dom-module id="login-components" assetpath="../components/"><template><style include="grid iron-flex">:host{display:block;height:calc(100% - 64px);}.logo-container{width:200px;height:48px;margin:20px auto;background:transparent;}.password-control{position:absolute;right:16px;top:21px;color:#FF3B30;cursor:pointer;user-select:none;}</style><app-location route="{{ route }}"></app-location><app-route route="{{ route }}" pattern="/login/:social" data="{{ routeData }}"></app-route><div class="h-100 p-y-1 flex layout vertical"><div class="logo-container"><iron-image src="/assets/images/thegrid.svg"></iron-image></div><form id="loginForm" class="form"><div class="input-group"><input id="username" type="text" class="input" placeholder="Email" on-keydown="watchEnter" value="{{username::input}}"></div><div class="input-group suffix"><input id="password" type="password" class="input" placeholder="Password" on-keydown="watchEnter"><div class="addon-suffix has-button"><paper-button class="red" on-click="tooglePassword">[[togglePasswordText]]</paper-button></div></div><div class="form-group"><paper-button class="w-100 white" on-tap="signIn"><span>LOGIN</span></paper-button></div></form><divider-text line-width="1px" line-color="#FFFFFF"><span class="white">Or</span></divider-text><div class="form-control"><social-button class="facebook" id="loginFacebook"><iron-icon class="icon" src="/assets/images/facebook.svg"></iron-icon><span>[[ facebook_login_text ]]</span></social-button></div><div class="form-control"><social-button id="loginGoogle" class="google" on-tap="loginGoogle"><iron-icon class="icon" src="/assets/images/google.svg"></iron-icon><span>Continue with Google</span></social-button></div><div class="flex"></div><div class="white"><p>By selecting create account or continue you agree to accept our Privacy Policy &amp; Terms of Use.</p></div></div></template><script>class LoginComponents extends GridNavigation(ReduxBehavior(Polymer.Element)){static get is(){return'login-components'}static get properties(){return{user:{type:Object,statePath:'user'},loginAttempt:{type:Number,value:0,notify:!0},loginError:{type:String,notify:!0},togglePasswordText:{type:String,value:'Show'},isPasswordHidden:{type:Boolean,value:!0},isLoggingIn:{type:Boolean,value:!1,notify:!0},isLoggedIn:{type:Boolean,notify:!0},username:{type:String,value:localStorage.getItem('email')||''}}}static get observers(){return['_passwordState(isPasswordHidden)','_routeDataChange(routeData)']}static get actions(){return{assignToken(a){return{type:'ASSIGN_TOKEN',token:a.access_token,user:a.user}},giveAccess(a){return{type:'GIVE_ACCESS',token:a.access_token,user:a.user}}}}constructor(){super(),this.fbConnected=!0,this.googleConnected=!0,this.facebook_login_text='Please wait...'}_passwordState(a){a?(this.togglePasswordText='Show',this.$.password.setAttribute('type','password')):(this.togglePasswordText='Hide',this.$.password.setAttribute('type','text'))}tooglePassword(){this.isPasswordHidden=!this.isPasswordHidden}watchEnter(a){13===a.keyCode&&this.signIn()}signIn(){const a=this.$.username,b=this.$.password,c=this;c.isLoggingIn=!0,c.isLoggedIn=!1,axios.post(API_URL+'/login',{email:a.value,password:b.value}).then((a)=>{c.isLoggingIn=!1,c.isLoggedIn=!0,c.dispatch('giveAccess',a.data),c.$.loginForm.reset()}).catch((a)=>{if(c.isLoggingIn=!1,c.isLoggedIn=!1,a.response){var b=a.response.data,d=c.loginAttempt+1;c.loginAttempt=d,c.loginError=b.message,c.$.username.focus()}})}loginGoogle(){}loadJsAPI(a,b){let c=document.createElement('script');c.type='text/javascript',c.onerror=this.googleApiError,b&&(c.onload=b);let d=document.getElementsByTagName('head')[0];d.appendChild(c),c.src=a}connectedCallback(){super.connectedCallback();const a=this;this.loadJsAPI('https://apis.google.com/js/client:platform.js',()=>{const a=this.$.loginGoogle;gapi.load('auth2',()=>{this.googleConnected=!0;var b=gapi.auth2.init({client_id:'186352805872-hqq59ghhfq4pdf6tttonigp3ipbgmdbb.apps.googleusercontent.com',cookiepolicy:'single_host_origin',scope:'profile'});b.attachClickHandler(a,{ux_mode:'popup'},(a)=>{const b=a.getBasicProfile(),c={id:b.getId(),name:b.getName(),email:b.getEmail()};this.signInSocial('google',c)},function(a){console.log('Sign-in error',a)})})}),this.loadJsAPI('//connect.facebook.net/en_US/sdk.js',()=>{this.facebook_login_text='Continue with Facebook',window.fbAsyncInit=()=>{FB.init({appId:'1451318644890504',cookie:!0,xfbml:!0,version:'v2.8'}),FB.AppEvents.logPageView(),FB.getLoginStatus((b)=>{const c=this.$.loginFacebook,d=()=>{FB.api('/me','GET',{fields:'first_name, last_name, email'},(b)=>{const c={id:b.id,name:b.first_name+' '+b.last_name,email:b.email};a.signInSocial('facebook',c)})};'connected'===b.status?((()=>{FB.api('/me','GET',{fields:'first_name, last_name, email'},(a)=>{this.facebook_login_text=`Continue as ${a.first_name}`})})(),'redirectfromfacebook'==this.routeData.social&&d(),this.fbConnected=!0,c.addEventListener('click',()=>{d()})):c.addEventListener('click',()=>{var a=`https://m.facebook.com/dialog/oauth?client_id=1451318644890504&response_type=code&redirect_uri=${window.location.href+'/redirectfromfacebook'}&scope=email`;window.location=a})})}})}signInSocial(a,b){this.isLoggingIn=!0,this.isLoggedIn=!1,axios.post(API_URL+'/login/'+a,b).then((a)=>{if(1==a.data.new_user){let b=a.data.user;window.localStorage.setItem('social_user',JSON.stringify(b)),this.redirectRegister()}else this.dispatch('giveAccess',a.data)}).then(()=>{this.isLoggingIn=!1,this.isLoggedIn=!0}).catch((a)=>{if(this.isLoggingIn=!1,this.isLoggedIn=!1,a.response){var b=a.response.data,c=this.loginAttempt+1;this.loginAttempt=c,this.loginError=a.response.data.message,this.$.username.focus()}})}_routeDataChange(a){'redirectfromfacebook'==a.social&&(this.isLoggingIn=!0)}}customElements.define(LoginComponents.is,LoginComponents);</script></dom-module></div><dom-module id="grid-login"><template><style include="iron-flex grid">:host{display:block;position:relative;width:100%;height:100%;margin:0 auto;background:var(--gradient-red);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column;}.header-action{height:56px;padding:16px;}</style><app-route route="{{route}}" pattern="/login/:provider/:token/:secret/:setup" data="{{loginData}}"></app-route><div id="toolbar" class="toolbar"><paper-icon-button icon="close" class="white pointer" on-click="redirectHome"></paper-icon-button><span class="flex"></span><paper-button class="white pointer" on-click="redirectRegister">SIGN UP</paper-button></div><main class="scroll-area flex"><login-components is-logging-in="{{isLoggingIn}}" is-logged-in="{{isLoggedIn}}" login-attempt="{{loginAttempt}}" login-error="{{loginError}}"></login-components></main><paper-toast id="loginErrToast" duration="5000" class="fit-bottom"><div class="flex layout horizontal"><span class="flex">[[loginError]]</span> <span><a href="/forgot" class="red anchor">FORGOT?</a></span></div></paper-toast><template is="dom-if" if="[[isLoggingIn]]"><div class="overlay loading-bg"><div class="align-center"><img src="/assets/images/grid-logo-text.svg" alt="THE GRID"><br><paper-spinner active$="[[isLoggingIn]]"></paper-spinner></div></div></template></template><script>class GridLogin extends GridNavigation(ReduxBehavior(Polymer.Element)){static get is(){return'grid-login'}static get properties(){return{auth:{type:Boolean,statePath:'auth'},setupAccount:{type:Boolean,value:!1,notify:!0}}}static get observers(){return['_onLoginError(loginAttempt)','_checkLogin(isLoggedIn)','_loginDataChange(loginData)','_isLoggingInChange(isLoggingIn)']}static get actions(){return{assignToken(a){return{type:'ASSIGN_TOKEN',token:a}}}}connectedCallback(){super.connectedCallback(),this.headerAnimate()}headerAnimate(){const a=this.shadowRoot.querySelector('#toolbar'),b=this.shadowRoot.querySelector('main');b.addEventListener('scroll',()=>{let c=b.scrollTop;0<c?a.classList.add('shadow'):a.classList.remove('shadow')})}register(){window.location.href=REGISTER_URL}close(){window.location.href=HOME_URL}_onLoginError(a){0<a&&(this.$.loginErrToast.fitInto=this,this.$.loginErrToast.open())}_checkLogin(a){a&&(this.$.loginErrToast.close(),this.redirectHome())}_loginDataChange(a){a&&a.provider&&a.secret&&a.token&&!this.isLoggingIn&&(this.isLoggingIn=!0,axios.post(API_BASE_URL+'/oauth/token',{grant_type:'social',client_id:2,client_secret:a.secret,network:a.provider,access_token:a.token}).then((b)=>{this.isLoggingIn=!1,this.isLoggedIn=!0,1==a.setup&&(this.setupAccount=!0),this.dispatch('assignToken',b.data)}).catch(()=>{this.isLoggingIn=!1}))}_isLoggingInChange(a){a&&this.$.loginErrToast.close()}}customElements.define(GridLogin.is,GridLogin);</script></dom-module></body></html>